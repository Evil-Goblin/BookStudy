## DRI(선언적 참조 무결성) 유지를 위해 제약 조건을 사용하라.
- 제약 조건을 사용하여 데이터베이스 무결성을 강화하도록 할 수 있다.
- 제약 조건은 컬럼에 허용된 값 규칙을 정의하며 무결성을 강화하는 표준 메커니즘이다.
- DML, 트리거, 규칙, 기본 값보다 제약 조건을 사용하는 것이 더 낫다.
  - 쿼리 옵티마이저는 제약 조건으로 더 나은 성능의 쿼리 실행 계획을 만든다.

### DRI
- `INSERT` 문에 대한 `DRI` 를 선언할 때 자식 테이블에 새 로우를 입력하면 `RDBMS` 는 입력된 키 값이 부모 테이블에 존재하는지 검사해 해당 키가 없으면 새 로우를 입력할 수 없게 한다.
- `CASCADE`(부모 테이블의 데이터를 견경하거나 삭제할 때 자식 테이블에 전파) , `NO ACTION`(해당 로우가 참조되고 있으면 키 값 변경이 불가) , `SET NULL/SET DEFAULT`(부모 테이블의 키 값을 변경하거나 삭제하면 자식 테이블의 값을 `NULL` 이나 기본 값으로 설정) 처럼 `UPDATE` ,`DELETE` 에도 `DRI` 를 적용할 수 있다.

```sql
ALTER TABLE Order_Details
  ADD CONSTRAINT fkOrder FOREIGN KEY (OrderNumber)
    REFERENCES Orders (OrderNumber) ON DELETE CASCADE;
```

```sql
CREATE TRIGGER DelCascadeTrig
  ON Orders
  FOR DELETE
AS
  DELETE Order_Details
  FROM Order_Details, deleted
  WHERE Order_Details.OrderNumber = deleted.OrderNumber;
```
- 부모 테이블의 키 값이 삭제되어 자식 테이블의 값이 길을 잃게 하는 것을 방지하기 위한 `DRI` 를 적용하는 방법과 트리거를 이용하는 방법이다.
- `DRI` 접근법이 트리거보다 빠르게 수행되며 더 효율적이다.

## 트리거 사용이 적절한 경우
- 중복 또는 파생 데이터의 관리
  - 역정규화된 데이터베이스는 일반적으로 데이터를 중복으로 저장한다.
  - 트리거를 이용해 이런 데이터를 동기화할 수 있다.
- 복잡한 컬럼 제약 조건
  - 컬럼의 제약 조건이 동일한 테이블의 다른 로우 또는 다른 테이블의 로우에 의존한다면, 트리거가 이 컬럼의 제약 조건을 유지하는 최상의 방법이다.
- 복잡한 기본 값
  - 다른 컬럼, 로우, 테이블에 있는 데이터를 기준으로 기본 값을 생성하는 데 트리거를 사용할 수 있다.
- 데이터베이스 간 참조 무결성
  - 관련 테이블을 두 데이터베이스에 나누었다면 트리거로 데이터베이스 간 참조 무결성을 확보할 수 있다.

## 정리
- 테이블을 생성할 때는 내장 기능으로 계산 컬럼과 제약 조건을 사용한 DRI 구현이 더 나은 성능을 보이므로, 제약 조건이나 계산 컬럼용 내장 기능을 사용하는 방법을 추천한다.
- 일반적으로 트리거는 이식성이 좋지 않다.
  - 한 DBMS 에서 생성한 트리거를 다른 DBMS 에서 수정하지 않으면 제대로 동작하지 않는다.
- 트리거는 필요할 때만 사용한다.
  - 가능하면 트리거가 멱등성이 있는지 확인한다.
  - 멱등성: 한 번 적용한 결과나 두 번 반복해 적용한 결과나 모두 같음
